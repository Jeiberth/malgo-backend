files:
  "/etc/nginx/conf.d/laravel_app.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      # Optional: Add these at the beginning if you're modifying the HTTP block
      types_hash_max_size 2048;
      types_hash_bucket_size 64;

      server {
          listen 80;
          server_name localhost;

          root /var/app/current/public;  # Laravel's public directory

          index index.php index.html index.htm;

          # Serve static assets like images, css, js files
          location / {
              try_files $uri $uri/ /index.php?$query_string;
          }

          # Handle PHP requests
          location ~ \.php$ {
              include fastcgi_params;
              fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;  # Adjust to the version of PHP you are using
              fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
          }

          # Deny access to .htaccess files
          location ~ /\.ht {
              deny all;
          }

          # Disable access to hidden files
          location ~ /\. {
              deny all;
          }
      }
